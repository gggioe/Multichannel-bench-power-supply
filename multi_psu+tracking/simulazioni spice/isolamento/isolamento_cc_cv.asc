Version 4
SHEET 1 2056 1876
WIRE -1616 -112 -1680 -112
WIRE -1488 -112 -1536 -112
WIRE -1488 -48 -1488 -112
WIRE 64 0 64 -32
WIRE 368 0 368 -32
WIRE -1680 48 -1680 -112
WIRE -1456 48 -1680 48
WIRE -1152 48 -1456 48
WIRE 64 128 64 80
WIRE 112 128 64 128
WIRE 368 128 368 80
WIRE 368 128 304 128
WIRE -1312 160 -1328 160
WIRE -1200 160 -1232 160
WIRE -1168 160 -1200 160
WIRE -1072 160 -1088 160
WIRE -1328 176 -1328 160
WIRE -1456 208 -1456 48
WIRE 112 224 64 224
WIRE 480 224 480 192
WIRE 480 224 304 224
WIRE 528 224 480 224
WIRE 656 224 608 224
WIRE 720 224 656 224
WIRE 848 224 848 160
WIRE 848 224 800 224
WIRE 1024 224 848 224
WIRE 656 240 656 224
WIRE 848 240 848 224
WIRE -1680 256 -1680 48
WIRE -1712 272 -1856 272
WIRE -1504 288 -1648 288
WIRE -1152 288 -1152 48
WIRE 64 288 64 224
WIRE 1808 288 1808 272
WIRE 1920 288 1808 288
WIRE -1712 304 -1792 304
WIRE -1200 304 -1200 160
WIRE -1184 304 -1200 304
WIRE 1808 304 1808 288
WIRE -1072 320 -1072 160
WIRE -1072 320 -1120 320
WIRE -1456 336 -1456 304
WIRE -1408 336 -1456 336
WIRE -1184 336 -1408 336
WIRE 656 336 656 304
WIRE 848 336 848 304
WIRE 1024 336 1024 304
WIRE -1680 352 -1680 320
WIRE -1536 352 -1680 352
WIRE -1472 352 -1536 352
WIRE -1408 352 -1408 336
WIRE -1536 368 -1536 352
WIRE 64 400 64 368
WIRE -1792 432 -1792 304
WIRE -1760 432 -1792 432
WIRE -1648 432 -1680 432
WIRE -288 448 -288 368
WIRE -160 448 -288 448
WIRE 0 448 -80 448
WIRE -1648 464 -1648 432
WIRE -1536 464 -1536 448
WIRE -1472 464 -1472 352
WIRE -1408 464 -1408 432
WIRE -1408 464 -1472 464
WIRE -1152 464 -1152 352
WIRE -1152 464 -1408 464
WIRE 1648 496 1456 496
WIRE -1856 512 -1856 272
WIRE -1072 512 -1072 320
WIRE -1072 512 -1856 512
WIRE -288 512 -288 448
WIRE 64 544 64 496
WIRE 1456 560 1456 496
WIRE 1472 560 1456 560
WIRE 1648 576 1536 576
WIRE 1744 576 1648 576
WIRE 1840 576 1824 576
WIRE 1856 576 1840 576
WIRE 1968 576 1936 576
WIRE 1472 592 1280 592
WIRE -288 624 -288 592
WIRE 1280 672 1280 592
WIRE 1840 688 1840 576
WIRE 1856 688 1840 688
WIRE 1968 704 1968 576
WIRE 1968 704 1920 704
WIRE 1856 720 1840 720
WIRE 1648 736 1456 736
WIRE 1456 800 1456 736
WIRE 1472 800 1456 800
WIRE 1648 816 1536 816
WIRE 1744 816 1648 816
WIRE 1840 816 1840 720
WIRE 1840 816 1824 816
WIRE 1856 816 1840 816
WIRE 1984 816 1936 816
WIRE 1280 832 1280 752
WIRE 1472 832 1280 832
WIRE 1984 848 1984 816
WIRE -96 992 -160 992
WIRE 16 992 -16 992
WIRE 16 1040 16 992
WIRE -720 1056 -768 1056
WIRE -592 1056 -656 1056
WIRE 192 1072 144 1072
WIRE 304 1072 272 1072
WIRE -320 1088 -352 1088
WIRE -208 1088 -240 1088
WIRE -1088 1168 -1088 1136
WIRE -32 1168 -32 1136
WIRE -688 1184 -688 1152
WIRE 224 1184 224 1152
WIRE 720 1184 720 1152
WIRE -272 1200 -272 1168
WIRE -1088 1264 -1088 1248
WIRE -1120 1280 -1264 1280
WIRE -688 1280 -688 1264
WIRE -32 1280 -32 1248
WIRE -960 1296 -1056 1296
WIRE -896 1296 -960 1296
WIRE -768 1296 -768 1056
WIRE -768 1296 -816 1296
WIRE -720 1296 -768 1296
WIRE -272 1296 -272 1280
WIRE -160 1296 -160 992
WIRE -64 1296 -160 1296
WIRE 224 1296 224 1264
WIRE -1120 1312 -1184 1312
WIRE -592 1312 -592 1056
WIRE -592 1312 -656 1312
WIRE -560 1312 -592 1312
WIRE -464 1312 -480 1312
WIRE -352 1312 -352 1088
WIRE -352 1312 -464 1312
WIRE -304 1312 -352 1312
WIRE 64 1312 0 1312
WIRE 144 1312 144 1072
WIRE 192 1312 144 1312
WIRE 304 1312 304 1072
WIRE 336 1312 304 1312
WIRE 480 1312 416 1312
WIRE 720 1312 720 1264
WIRE 720 1312 672 1312
WIRE -720 1328 -800 1328
WIRE -208 1328 -208 1088
WIRE -208 1328 -240 1328
WIRE -64 1328 -208 1328
WIRE 304 1328 304 1312
WIRE 304 1328 256 1328
WIRE -304 1344 -352 1344
WIRE 192 1344 144 1344
WIRE -1088 1360 -1088 1328
WIRE -464 1360 -464 1312
WIRE -960 1376 -960 1296
WIRE -800 1376 -800 1328
WIRE -688 1376 -688 1344
WIRE -32 1376 -32 1344
WIRE -1264 1392 -1264 1280
WIRE -352 1392 -352 1344
WIRE -272 1392 -272 1360
WIRE 144 1392 144 1344
WIRE 224 1392 224 1360
WIRE 480 1408 448 1408
WIRE 720 1408 672 1408
WIRE 848 1408 848 1392
WIRE 848 1408 720 1408
WIRE 720 1440 720 1408
WIRE -1088 1472 -1088 1440
WIRE -688 1488 -688 1456
WIRE -464 1488 -464 1440
WIRE -32 1488 -32 1456
WIRE 448 1488 448 1408
WIRE -272 1504 -272 1472
WIRE 224 1504 224 1472
WIRE -1184 1520 -1184 1312
WIRE -960 1520 -960 1456
WIRE -960 1520 -1184 1520
WIRE -880 1520 -960 1520
WIRE -592 1520 -592 1312
WIRE -592 1520 -800 1520
WIRE 720 1568 720 1520
WIRE -464 1600 -464 1568
FLAG 656 336 0
FLAG 368 -32 0
FLAG 480 192 PWM_OUT
FLAG 64 -32 0
FLAG 64 544 0
FLAG 848 336 0
FLAG 848 160 ANALOG_OUT
FLAG -288 624 0
FLAG -288 368 PWM_IN
FLAG 1024 336 0
FLAG 720 1152 0
FLAG 720 1568 0
FLAG 848 1392 PWM2_OUT
FLAG -160 992 ANALOG_IN
FLAG -1264 1392 0
FLAG -1088 1136 0
FLAG -688 1152 0
FLAG -1088 1472 0
FLAG -688 1488 0
FLAG -800 1376 0
FLAG 16 1040 0
FLAG -272 1504 0
FLAG 448 1488 0
FLAG -272 1168 0
FLAG -464 1600 0
FLAG -352 1392 0
FLAG -32 1488 0
FLAG -32 1136 0
FLAG 224 1504 0
FLAG 224 1152 0
FLAG 144 1392 0
FLAG 1984 848 0
FLAG 1808 192 +5
FLAG 1920 288 0
FLAG 1808 384 -5
FLAG 1504 848 -5
FLAG 1504 608 -5
FLAG 1888 736 -5
FLAG 1504 544 +5
FLAG 1504 784 +5
FLAG 1888 672 +5
FLAG -1488 -48 0
FLAG -1648 464 0
FLAG -1328 176 0
FLAG -1536 464 0
DATAFLAG -1072 320 ""
DATAFLAG -1248 336 ""
DATAFLAG -1776 272 ""
DATAFLAG -1744 304 ""
DATAFLAG -1568 288 ""
SYMBOL Optos\\PC817A 208 176 R0
SYMATTR InstName U1
SYMBOL res 624 208 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 2k
SYMBOL voltage 368 96 R180
WINDOW 0 24 96 Left 2
WINDOW 3 24 16 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 5
SYMBOL npn 0 400 R0
SYMATTR InstName Q1
SYMBOL voltage 64 96 R180
WINDOW 0 24 96 Left 2
WINDOW 3 24 16 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 5
SYMBOL res 48 272 R0
SYMATTR InstName R2
SYMATTR Value 220
SYMBOL cap 640 240 R0
SYMATTR InstName C1
SYMATTR Value 1µ
SYMBOL res 816 208 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 2k
SYMBOL cap 832 240 R0
SYMATTR InstName C2
SYMATTR Value 1µ
SYMBOL voltage -288 496 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value PULSE(0 5 0 0 0 0.0005 0.001)
SYMBOL res -64 432 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 1k
SYMBOL res 1008 208 R0
SYMATTR InstName R5
SYMATTR Value 100k
SYMBOL Optos\\PC817A 576 1360 R0
SYMATTR InstName U3
SYMBOL voltage 720 1280 R180
WINDOW 0 24 96 Left 2
WINDOW 3 24 16 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V7
SYMATTR Value 5
SYMBOL res 704 1424 R0
SYMATTR InstName R7
SYMATTR Value 10k
SYMBOL OpAmps\\LT1001 -32 1248 R0
SYMATTR InstName U2
SYMBOL OpAmps\\LT1001 -688 1248 R0
SYMATTR InstName U4
SYMBOL OpAmps\\LT1001 -1088 1232 R0
SYMATTR InstName U5
SYMBOL res -976 1360 R0
SYMATTR InstName R8
SYMATTR Value 15k
SYMBOL res -896 1536 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R9
SYMATTR Value 10k
SYMBOL voltage -1088 1264 R180
WINDOW 0 24 96 Left 2
WINDOW 3 24 16 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value 5
SYMBOL res -800 1280 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value 1k
SYMBOL cap -656 1040 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C4
SYMATTR Value 220n
SYMBOL voltage -688 1280 R180
WINDOW 0 24 96 Left 2
WINDOW 3 24 16 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V5
SYMATTR Value 5
SYMBOL voltage -1088 1456 R180
WINDOW 0 24 96 Left 2
WINDOW 3 24 16 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V9
SYMATTR Value 5
SYMBOL voltage -688 1472 R180
WINDOW 0 24 96 Left 2
WINDOW 3 24 16 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V10
SYMATTR Value 5
SYMBOL voltage -112 992 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 -32 56 VBottom 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V11
SYMATTR Value 0.1
SYMBOL voltage -32 1264 R180
WINDOW 0 24 96 Left 2
WINDOW 3 24 16 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V12
SYMATTR Value 12
SYMBOL res 432 1296 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 1k
SYMBOL OpAmps\\LT1001 -272 1264 R0
SYMATTR InstName U6
SYMBOL voltage -272 1296 R180
WINDOW 0 24 96 Left 2
WINDOW 3 24 16 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V8
SYMATTR Value 12
SYMBOL voltage -464 1472 R0
WINDOW 0 24 96 Left 2
WINDOW 3 24 16 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V13
SYMATTR Value -2.4
SYMBOL res -224 1072 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 10k
SYMBOL res -480 1344 R0
SYMATTR InstName R12
SYMATTR Value 10k
SYMBOL res -464 1296 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R13
SYMATTR Value 10k
SYMBOL voltage -272 1488 R180
WINDOW 0 24 96 Left 2
WINDOW 3 24 16 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V6
SYMATTR Value 12
SYMBOL voltage -32 1472 R180
WINDOW 0 24 96 Left 2
WINDOW 3 24 16 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V14
SYMATTR Value 12
SYMBOL OpAmps\\LT1001 224 1264 R0
SYMATTR InstName U7
SYMBOL voltage 224 1280 R180
WINDOW 0 24 96 Left 2
WINDOW 3 24 16 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V15
SYMATTR Value 12
SYMBOL voltage 224 1488 R180
WINDOW 0 24 96 Left 2
WINDOW 3 24 16 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V16
SYMATTR Value 12
SYMBOL res 288 1056 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R14
SYMATTR Value 1k
SYMBOL res 160 1296 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R15
SYMATTR Value 1k
SYMBOL OpAmps\\LT1001 1504 512 R0
SYMATTR InstName U8
SYMBOL OpAmps\\LT1001 1504 752 R0
SYMATTR InstName U9
SYMBOL OpAmps\\LT1001 1888 640 R0
SYMATTR InstName U10
SYMBOL res 1664 592 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R17
SYMATTR Value 100k
SYMBOL res 1632 720 R0
SYMATTR InstName R18
SYMATTR Value 100k
SYMBOL res 1840 560 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R19
SYMATTR Value 100k
SYMBOL res 1840 800 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R20
SYMATTR Value 100k
SYMBOL res 1952 560 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R21
SYMATTR Value 100k
SYMBOL res 1952 800 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R22
SYMATTR Value 100k
SYMBOL voltage 1808 176 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V17
SYMATTR Value 2.5
SYMBOL voltage 1280 768 R180
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V18
SYMATTR Value 0.1
SYMBOL voltage 1808 288 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V19
SYMATTR Value 2.5
SYMBOL OpAmps\\LT1001 -1680 224 R0
SYMATTR InstName U11
SYMBOL nmos -1504 208 R0
SYMATTR InstName M1
SYMATTR Value PSMN0R925YLC
SYMBOL res -1424 336 R0
SYMATTR InstName R16
SYMATTR Value 0.01
SYMBOL voltage -1632 -112 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 -32 56 VBottom 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V22
SYMATTR Value 12
SYMBOL voltage -1776 432 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 -32 56 VBottom 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V23
SYMATTR Value 0.01
SYMBOL OpAmps\\LT1001 -1152 256 R0
SYMATTR InstName U12
SYMBOL res -1216 144 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R23
SYMATTR Value 1k
SYMBOL res -1072 144 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R24
SYMATTR Value 65.66k
SYMBOL voltage -1536 464 R180
WINDOW 0 32 56 VTop 2
WINDOW 3 -32 56 VBottom 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V21
SYMATTR Value 12
TEXT -712 824 Left 2 !.tran 0.01
